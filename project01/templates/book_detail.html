{% extends "layout.html" %}

{% block title %}{{ book.title }} - 校园闲置书籍共享平台{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12 mb-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('index') }}">首页</a></li>
                <li class="breadcrumb-item active">{{ book.title }}</li>
            </ol>
        </nav>
    </div>
</div>

<div class="row">
    <div class="col-md-5">
        {% if book.image %}
        <img src="{{ book.image }}" class="img-fluid rounded" alt="{{ book.title }}">
        {% else %}
        <div class="bg-light text-center py-5 rounded">
            <span class="text-muted fs-4">暂无图片</span>
        </div>
        {% endif %}
    </div>
    <div class="col-md-7">
        <h2>{{ book.title }}</h2>
        <p class="text-muted">作者: {{ book.author }}</p>
        
        <div class="mb-3">
            <span class="badge bg-{{ 'success' if book.status == 'available' else 'secondary' }}">
                {{ '可购买' if book.status == 'available' else '已售出' }}
            </span>
            <span class="badge bg-info">{{ book.condition }}</span>
        </div>
        
        <h3 class="text-danger mb-4">¥{{ book.price }}</h3>
        
        <div class="mb-4">
            <h5>书籍描述</h5>
            <p>{{ book.description }}</p>
        </div>
        
        <div class="mb-4">
            <h5>卖家信息</h5>
            <p>卖家: {{ book.seller_name }}</p>
            <p>上架时间: {{ book.created_at }}</p>
        </div>
        
        {% if book.status == 'available' and 'user_id' in session and book.seller_id != session['user_id'] %}
        <div class="d-grid gap-2">
            <a href="{{ url_for('place_order', book_id=book.id) }}" class="btn btn-primary btn-lg">立即购买</a>
        </div>
        {% elif book.status == 'available' and 'user_id' not in session %}
        <div class="d-grid gap-2">
            <a href="{{ url_for('login') }}" class="btn btn-primary btn-lg">登录后购买</a>
        </div>
        {% elif book.status == 'available' and book.seller_id == session['user_id'] %}
        <div class="alert alert-info">
            这是您上传的书籍，无法购买自己的书籍
        </div>
        {% else %}
        <div class="alert alert-secondary">
            该书籍已售出
        </div>
        {% endif %}
    </div>
</div>

<div class="row mt-5">
    <div class="col-md-12">
        <h4>相关推荐</h4>
        <hr>
        <p class="text-muted">更多相关书籍正在整理中...</p>
    </div>
</div>
{% endblock %}